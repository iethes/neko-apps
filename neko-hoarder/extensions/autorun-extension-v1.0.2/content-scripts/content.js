var content=function(){"use strict";function vn(t){return t}const X=globalThis.browser?.runtime?.id?globalThis.browser:globalThis.chrome,Ft=!1,$t=(t,e)=>t===e,z=Symbol("solid-proxy"),st=Symbol("solid-track"),ie={equals:$t};let nt=ct;const U=1,ae=2,rt={owned:null,cleanups:null,context:null,owner:null};var v=null;let Se=null,Ut=null,x=null,I=null,F=null,le=0;function jt(t,e){const s=x,n=v,r=t.length===0,o=e===void 0?n:e,i=r?rt:{owned:null,cleanups:null,context:o?o.context:null,owner:o},a=r?t:()=>t(()=>Y(()=>ee(i)));v=i,x=null;try{return K(a,!0)}finally{x=s,v=n}}function ot(t,e){e=e?Object.assign({},ie,e):ie;const s={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=r=>(typeof r=="function"&&(r=r(s.value)),lt(s,r));return[at.bind(s),n]}function Pe(t,e,s){const n=Me(t,e,!1,U);Q(n)}function it(t,e,s){nt=Zt;const n=Me(t,e,!1,U);n.user=!0,F?F.push(n):Q(n)}function Ce(t,e,s){s=s?Object.assign({},ie,s):ie;const n=Me(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=s.equals||void 0,Q(n),at.bind(n)}function Bt(t){return K(t,!1)}function Y(t){if(x===null)return t();const e=x;x=null;try{return t()}finally{x=e}}function zt(t){return v===null||(v.cleanups===null?v.cleanups=[t]:v.cleanups.push(t)),t}function Ie(){return x}function at(){if(this.sources&&this.state)if(this.state===U)Q(this);else{const t=I;I=null,K(()=>ue(this),!1),I=t}if(x){const t=this.observers?this.observers.length:0;x.sources?(x.sources.push(this),x.sourceSlots.push(t)):(x.sources=[this],x.sourceSlots=[t]),this.observers?(this.observers.push(x),this.observerSlots.push(x.sources.length-1)):(this.observers=[x],this.observerSlots=[x.sources.length-1])}return this.value}function lt(t,e,s){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&K(()=>{for(let r=0;r<t.observers.length;r+=1){const o=t.observers[r],i=Se&&Se.running;i&&Se.disposed.has(o),(i?!o.tState:!o.state)&&(o.pure?I.push(o):F.push(o),o.observers&&ut(o)),i||(o.state=U)}if(I.length>1e6)throw I=[],new Error},!1)),e}function Q(t){if(!t.fn)return;ee(t);const e=le;Wt(t,t.value,e)}function Wt(t,e,s){let n;const r=v,o=x;x=v=t;try{n=t.fn(e)}catch(i){return t.pure&&(t.state=U,t.owned&&t.owned.forEach(ee),t.owned=null),t.updatedAt=s+1,dt(i)}finally{x=o,v=r}(!t.updatedAt||t.updatedAt<=s)&&(t.updatedAt!=null&&"observers"in t?lt(t,n):t.value=n,t.updatedAt=s)}function Me(t,e,s,n=U,r){const o={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:v,context:v?v.context:null,pure:s};return v===null||v!==rt&&(v.owned?v.owned.push(o):v.owned=[o]),o}function ce(t){if(t.state===0)return;if(t.state===ae)return ue(t);if(t.suspense&&Y(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<le);)t.state&&e.push(t);for(let s=e.length-1;s>=0;s--)if(t=e[s],t.state===U)Q(t);else if(t.state===ae){const n=I;I=null,K(()=>ue(t,e[0]),!1),I=n}}function K(t,e){if(I)return t();let s=!1;e||(I=[]),F?s=!0:F=[],le++;try{const n=t();return Kt(s),n}catch(n){s||(F=null),I=null,dt(n)}}function Kt(t){if(I&&(ct(I),I=null),t)return;const e=F;F=null,e.length&&K(()=>nt(e),!1)}function ct(t){for(let e=0;e<t.length;e++)ce(t[e])}function Zt(t){let e,s=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[s++]=n:ce(n)}for(e=0;e<s;e++)ce(t[e])}function ue(t,e){t.state=0;for(let s=0;s<t.sources.length;s+=1){const n=t.sources[s];if(n.sources){const r=n.state;r===U?n!==e&&(!n.updatedAt||n.updatedAt<le)&&ce(n):r===ae&&ue(n,e)}}}function ut(t){for(let e=0;e<t.observers.length;e+=1){const s=t.observers[e];s.state||(s.state=ae,s.pure?I.push(s):F.push(s),s.observers&&ut(s))}}function ee(t){let e;if(t.sources)for(;t.sources.length;){const s=t.sources.pop(),n=t.sourceSlots.pop(),r=s.observers;if(r&&r.length){const o=r.pop(),i=s.observerSlots.pop();n<r.length&&(o.sourceSlots[i]=n,r[n]=o,s.observerSlots[n]=i)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)ee(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)ee(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Gt(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function dt(t,e=v){throw Gt(t)}function qt(t,e){return Y(()=>t(e||{}))}const Vt=t=>`Stale read from <${t}>.`;function Ht(t){const e=t.keyed,s=Ce(()=>t.when,void 0,void 0),n=e?s:Ce(s,void 0,{equals:(r,o)=>!r==!o});return Ce(()=>{const r=n();if(r){const o=t.children;return typeof o=="function"&&o.length>0?Y(()=>o(e?r:()=>{if(!Y(n))throw Vt("Show");return s()})):o}return t.fallback},void 0,void 0)}function Te(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Oe,mt;function Jt(){if(mt)return Oe;mt=1;var t=/^[a-z](?:[\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*-(?:[\x2D\.0-9_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,e=function(s){return t.test(s)};return Oe=e,Oe}var Xt=Jt();const Yt=Te(Xt);var Qt=(t,e,s)=>new Promise((n,r)=>{var o=l=>{try{a(s.next(l))}catch(c){r(c)}},i=l=>{try{a(s.throw(l))}catch(c){r(c)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,i);a((s=s.apply(t,e)).next())});function es(t){return Qt(this,null,function*(){const{name:e,mode:s="closed",css:n,isolateEvents:r=!1}=t;if(!Yt(e))throw Error(`"${e}" is not a valid custom element name. It must be two words and kebab-case, with a few exceptions. See spec for more details: https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name`);const o=document.createElement(e),i=o.attachShadow({mode:s}),a=document.createElement("html"),l=document.createElement("body"),c=document.createElement("head");if(n){const u=document.createElement("style");"url"in n?u.textContent=yield fetch(n.url).then(d=>d.text()):u.textContent=n.textContent,c.appendChild(u)}return a.appendChild(c),a.appendChild(l),i.appendChild(a),r&&(Array.isArray(r)?r:["keydown","keyup","keypress"]).forEach(d=>{l.addEventListener(d,p=>p.stopPropagation())}),{parentElement:o,shadow:i,isolatedElement:l}})}const ts=Symbol("null");let ss=0;class ns extends Map{constructor(){super(),this._objectHashes=new WeakMap,this._symbolHashes=new Map,this._publicKeys=new Map;const[e]=arguments;if(e!=null){if(typeof e[Symbol.iterator]!="function")throw new TypeError(typeof e+" is not iterable (cannot read property Symbol(Symbol.iterator))");for(const[s,n]of e)this.set(s,n)}}_getPublicKeys(e,s=!1){if(!Array.isArray(e))throw new TypeError("The keys parameter must be an array");const n=this._getPrivateKey(e,s);let r;return n&&this._publicKeys.has(n)?r=this._publicKeys.get(n):s&&(r=[...e],this._publicKeys.set(n,r)),{privateKey:n,publicKey:r}}_getPrivateKey(e,s=!1){const n=[];for(let r of e){r===null&&(r=ts);const o=typeof r=="object"||typeof r=="function"?"_objectHashes":typeof r=="symbol"?"_symbolHashes":!1;if(!o)n.push(r);else if(this[o].has(r))n.push(this[o].get(r));else if(s){const i=`@@mkm-ref-${ss++}@@`;this[o].set(r,i),n.push(i)}else return!1}return JSON.stringify(n)}set(e,s){const{publicKey:n}=this._getPublicKeys(e,!0);return super.set(n,s)}get(e){const{publicKey:s}=this._getPublicKeys(e);return super.get(s)}has(e){const{publicKey:s}=this._getPublicKeys(e);return super.has(s)}delete(e){const{publicKey:s,privateKey:n}=this._getPublicKeys(e);return!!(s&&super.delete(s)&&this._publicKeys.delete(n))}clear(){super.clear(),this._symbolHashes.clear(),this._publicKeys.clear()}get[Symbol.toStringTag](){return"ManyKeysMap"}get size(){return super.size}}function Re(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function Le(t,e,s=".",n){if(!Re(e))return Le(t,{},s,n);const r=Object.assign({},e);for(const o in t){if(o==="__proto__"||o==="constructor")continue;const i=t[o];i!=null&&(n&&n(r,o,i,s)||(Array.isArray(i)&&Array.isArray(r[o])?r[o]=[...i,...r[o]]:Re(i)&&Re(r[o])?r[o]=Le(i,r[o],(s?`${s}.`:"")+o.toString(),n):r[o]=i))}return r}function rs(t){return(...e)=>e.reduce((s,n)=>Le(s,n,"",t),{})}const os=rs(),gt=t=>t!==null?{isDetected:!0,result:t}:{isDetected:!1},is=t=>t===null?{isDetected:!0,result:null}:{isDetected:!1},as=()=>({target:globalThis.document,unifyProcess:!0,detector:gt,observeConfigs:{childList:!0,subtree:!0,attributes:!0},signal:void 0,customMatcher:void 0}),ls=(t,e)=>os(t,e),Ne=new ns;function cs(t){const{defaultOptions:e}=t;return(s,n)=>{const{target:r,unifyProcess:o,observeConfigs:i,detector:a,signal:l,customMatcher:c}=ls(n,e),u=[s,r,o,i,a,l,c],d=Ne.get(u);if(o&&d)return d;const p=new Promise(async(h,w)=>{if(l?.aborted)return w(l.reason);const _=new MutationObserver(async B=>{for(const D of B){if(l?.aborted){_.disconnect();break}const N=await ft({selector:s,target:r,detector:a,customMatcher:c});if(N.isDetected){_.disconnect(),h(N.result);break}}});l?.addEventListener("abort",()=>(_.disconnect(),w(l.reason)),{once:!0});const S=await ft({selector:s,target:r,detector:a,customMatcher:c});if(S.isDetected)return h(S.result);_.observe(r,i)}).finally(()=>{Ne.delete(u)});return Ne.set(u,p),p}}async function ft({target:t,selector:e,detector:s,customMatcher:n}){const r=n?n(e):t.querySelector(e);return await s(r)}const us=cs({defaultOptions:as()});function de(t,...e){}const De={debug:(...t)=>de(console.debug,...t),log:(...t)=>de(console.log,...t),warn:(...t)=>de(console.warn,...t),error:(...t)=>de(console.error,...t)};function ds(t,e,s){s.position!=="inline"&&(s.zIndex!=null&&(t.style.zIndex=String(s.zIndex)),t.style.overflow="visible",t.style.position="relative",t.style.width="0",t.style.height="0",t.style.display="block",e&&(s.position==="overlay"?(e.style.position="absolute",s.alignment?.startsWith("bottom-")?e.style.bottom="0":e.style.top="0",s.alignment?.endsWith("-right")?e.style.right="0":e.style.left="0"):(e.style.position="fixed",e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0")))}function ke(t){if(t.anchor==null)return document.body;let e=typeof t.anchor=="function"?t.anchor():t.anchor;return typeof e=="string"?e.startsWith("/")?document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue??void 0:document.querySelector(e)??void 0:e??void 0}function ms(t,e){const s=ke(e);if(s==null)throw Error("Failed to mount content script UI: could not find anchor element");switch(e.append){case void 0:case"last":s.append(t);break;case"first":s.prepend(t);break;case"replace":s.replaceWith(t);break;case"after":s.parentElement?.insertBefore(t,s.nextElementSibling);break;case"before":s.parentElement?.insertBefore(t,s);break;default:e.append(s,t);break}}function gs(t,e){let s;const n=()=>{s?.stopAutoMount(),s=void 0},r=()=>{t.mount()},o=t.remove;return{mount:r,remove:()=>{n(),t.remove()},autoMount:l=>{s&&De.warn("autoMount is already set."),s=fs({mount:r,unmount:o,stopAutoMount:n},{...e,...l})}}}function fs(t,e){const s=new AbortController,n="explicit_stop_auto_mount",r=()=>{s.abort(n),e.onStop?.()};let o=typeof e.anchor=="function"?e.anchor():e.anchor;if(o instanceof Element)throw Error("autoMount and Element anchor option cannot be combined. Avoid passing `Element` directly or `() => Element` to the anchor.");async function i(a){let l=!!ke(e);for(l&&t.mount();!s.signal.aborted;)try{l=!!await us(a??"body",{customMatcher:()=>ke(e)??null,detector:l?is:gt,signal:s.signal}),l?t.mount():(t.unmount(),e.once&&t.stopAutoMount())}catch(c){if(s.signal.aborted&&s.signal.reason===n)break;throw c}}return i(o),{stopAutoMount:r}}function hs(t){let e=t,s="";const n=/(\s*@(property|font-face)[\s\S]*?{[\s\S]*?})/gm;let r;for(;(r=n.exec(t))!==null;)s+=r[1],e=e.replace(r[1],"");return{documentCss:s.trim(),shadowCss:e.trim()}}async function ps(t,e){const s=Math.random().toString(36).substring(2,15),n=[];if(e.inheritStyles||n.push("/* WXT Shadow Root Reset */ :host{all:initial !important;}"),e.css&&n.push(e.css),t.options?.cssInjectionMode==="ui"){const h=await ys();n.push(h.replaceAll(":root",":host"))}const{shadowCss:r,documentCss:o}=hs(n.join(`
`).trim()),{isolatedElement:i,parentElement:a,shadow:l}=await es({name:e.name,css:{textContent:r},mode:e.mode??"open",isolateEvents:e.isolateEvents});a.setAttribute("data-wxt-shadow-root","");let c;const u=()=>{if(ms(a,e),ds(a,l.querySelector("html"),e),o&&!document.querySelector(`style[wxt-shadow-root-document-styles="${s}"]`)){const h=document.createElement("style");h.textContent=o,h.setAttribute("wxt-shadow-root-document-styles",s),(document.head??document.body).append(h)}c=e.onMount(i,l,a)},d=()=>{for(e.onRemove?.(c),a.remove(),document.querySelector(`style[wxt-shadow-root-document-styles="${s}"]`)?.remove();i.lastChild;)i.removeChild(i.lastChild);c=void 0},p=gs({mount:u,remove:d},e);return t.onInvalidated(d),{shadow:l,shadowHost:a,uiContainer:i,...p,get mounted(){return c}}}async function ys(){const t=X.runtime.getURL("/content-scripts/content.css");try{return await(await fetch(t)).text()}catch(e){return De.warn(`Failed to load styles @ ${t}. Did you forget to import the stylesheet in your entrypoint?`,e),""}}function As(t,e,s){let n=s.length,r=e.length,o=n,i=0,a=0,l=e[r-1].nextSibling,c=null;for(;i<r||a<o;){if(e[i]===s[a]){i++,a++;continue}for(;e[r-1]===s[o-1];)r--,o--;if(r===i){const u=o<n?a?s[a-1].nextSibling:s[o-a]:l;for(;a<o;)t.insertBefore(s[a++],u)}else if(o===a)for(;i<r;)(!c||!c.has(e[i]))&&e[i].remove(),i++;else if(e[i]===s[o-1]&&s[a]===e[r-1]){const u=e[--r].nextSibling;t.insertBefore(s[a++],e[i++].nextSibling),t.insertBefore(s[--o],u),e[r]=s[o]}else{if(!c){c=new Map;let d=a;for(;d<o;)c.set(s[d],d++)}const u=c.get(e[i]);if(u!=null)if(a<u&&u<o){let d=i,p=1,h;for(;++d<r&&d<o&&!((h=c.get(e[d]))==null||h!==u+p);)p++;if(p>u-a){const w=e[i];for(;a<u;)t.insertBefore(s[a++],w)}else t.replaceChild(s[a++],e[i++])}else i++;else e[i++].remove()}}}function ws(t,e,s,n={}){let r;return jt(o=>{r=o,e===document?t():Z(e,t(),e.firstChild?null:void 0,s)},n.owner),()=>{r(),e.textContent=""}}function me(t,e,s,n){let r;const o=()=>{const a=document.createElement("template");return a.innerHTML=t,a.content.firstChild},i=()=>(r||(r=o())).cloneNode(!0);return i.cloneNode=i,i}function Z(t,e,s,n){if(s!==void 0&&!n&&(n=[]),typeof e!="function")return ge(t,e,n,s);Pe(r=>ge(t,e(),r,s),n)}function ge(t,e,s,n,r){for(;typeof s=="function";)s=s();if(e===s)return s;const o=typeof e,i=n!==void 0;if(t=i&&s[0]&&s[0].parentNode||t,o==="string"||o==="number"){if(o==="number"&&(e=e.toString(),e===s))return s;if(i){let a=s[0];a&&a.nodeType===3?a.data!==e&&(a.data=e):a=document.createTextNode(e),s=G(t,s,n,a)}else s!==""&&typeof s=="string"?s=t.firstChild.data=e:s=t.textContent=e}else if(e==null||o==="boolean")s=G(t,s,n);else{if(o==="function")return Pe(()=>{let a=e();for(;typeof a=="function";)a=a();s=ge(t,a,s,n)}),()=>s;if(Array.isArray(e)){const a=[],l=s&&Array.isArray(s);if(Fe(a,e,s,r))return Pe(()=>s=ge(t,a,s,n,!0)),()=>s;if(a.length===0){if(s=G(t,s,n),i)return s}else l?s.length===0?ht(t,a,n):As(t,s,a):(s&&G(t),ht(t,a));s=a}else if(e.nodeType){if(Array.isArray(s)){if(i)return s=G(t,s,n,e);G(t,s,null,e)}else s==null||s===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);s=e}}return s}function Fe(t,e,s,n){let r=!1;for(let o=0,i=e.length;o<i;o++){let a=e[o],l=s&&s[t.length],c;if(!(a==null||a===!0||a===!1))if((c=typeof a)=="object"&&a.nodeType)t.push(a);else if(Array.isArray(a))r=Fe(t,a,l)||r;else if(c==="function")if(n){for(;typeof a=="function";)a=a();r=Fe(t,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||r}else t.push(a),r=!0;else{const u=String(a);l&&l.nodeType===3&&l.data===u?t.push(l):t.push(document.createTextNode(u))}}return r}function ht(t,e,s=null){for(let n=0,r=e.length;n<r;n++)t.insertBefore(e[n],s)}function G(t,e,s,n){if(s===void 0)return t.textContent="";const r=n||document.createTextNode("");if(e.length){let o=!1;for(let i=e.length-1;i>=0;i--){const a=e[i];if(r!==a){const l=a.parentNode===t;!o&&!i?l?t.replaceChild(r,a):t.insertBefore(r,s):l&&a.remove()}else o=!0}}else t.insertBefore(r,s);return[r]}const $e=Symbol("store-raw"),q=Symbol("store-node"),$=Symbol("store-has"),pt=Symbol("store-self");function yt(t){let e=t[z];if(!e&&(Object.defineProperty(t,z,{value:e=new Proxy(t,xs)}),!Array.isArray(t))){const s=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let r=0,o=s.length;r<o;r++){const i=s[r];n[i].get&&Object.defineProperty(t,i,{enumerable:n[i].enumerable,get:n[i].get.bind(e)})}}return e}function fe(t){let e;return t!=null&&typeof t=="object"&&(t[z]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function te(t,e=new Set){let s,n,r,o;if(s=t!=null&&t[$e])return s;if(!fe(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let i=0,a=t.length;i<a;i++)r=t[i],(n=te(r,e))!==r&&(t[i]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const i=Object.keys(t),a=Object.getOwnPropertyDescriptors(t);for(let l=0,c=i.length;l<c;l++)o=i[l],!a[o].get&&(r=t[o],(n=te(r,e))!==r&&(t[o]=n))}return t}function he(t,e){let s=t[e];return s||Object.defineProperty(t,e,{value:s=Object.create(null)}),s}function se(t,e,s){if(t[e])return t[e];const[n,r]=ot(s,{equals:!1,internal:!0});return n.$=r,t[e]=n}function bs(t,e){const s=Reflect.getOwnPropertyDescriptor(t,e);return!s||s.get||!s.configurable||e===z||e===q||(delete s.value,delete s.writable,s.get=()=>t[z][e]),s}function At(t){Ie()&&se(he(t,q),pt)()}function Es(t){return At(t),Reflect.ownKeys(t)}const xs={get(t,e,s){if(e===$e)return t;if(e===z)return s;if(e===st)return At(t),s;const n=he(t,q),r=n[e];let o=r?r():t[e];if(e===q||e===$||e==="__proto__")return o;if(!r){const i=Object.getOwnPropertyDescriptor(t,e);Ie()&&(typeof o!="function"||t.hasOwnProperty(e))&&!(i&&i.get)&&(o=se(n,e,o)())}return fe(o)?yt(o):o},has(t,e){return e===$e||e===z||e===st||e===q||e===$||e==="__proto__"?!0:(Ie()&&se(he(t,$),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Es,getOwnPropertyDescriptor:bs};function pe(t,e,s,n=!1){if(!n&&t[e]===s)return;const r=t[e],o=t.length;s===void 0?(delete t[e],t[$]&&t[$][e]&&r!==void 0&&t[$][e].$()):(t[e]=s,t[$]&&t[$][e]&&r===void 0&&t[$][e].$());let i=he(t,q),a;if((a=se(i,e,r))&&a.$(()=>s),Array.isArray(t)&&t.length!==o){for(let l=t.length;l<o;l++)(a=i[l])&&a.$();(a=se(i,"length",o))&&a.$(t.length)}(a=i[pt])&&a.$()}function wt(t,e){const s=Object.keys(e);for(let n=0;n<s.length;n+=1){const r=s[n];pe(t,r,e[r])}}function vs(t,e){if(typeof e=="function"&&(e=e(t)),e=te(e),Array.isArray(e)){if(t===e)return;let s=0,n=e.length;for(;s<n;s++){const r=e[s];t[s]!==r&&pe(t,s,r)}pe(t,"length",n)}else wt(t,e)}function ne(t,e,s=[]){let n,r=t;if(e.length>1){n=e.shift();const i=typeof n,a=Array.isArray(t);if(Array.isArray(n)){for(let l=0;l<n.length;l++)ne(t,[n[l]].concat(e),s);return}else if(a&&i==="function"){for(let l=0;l<t.length;l++)n(t[l],l)&&ne(t,[l].concat(e),s);return}else if(a&&i==="object"){const{from:l=0,to:c=t.length-1,by:u=1}=n;for(let d=l;d<=c;d+=u)ne(t,[d].concat(e),s);return}else if(e.length>1){ne(t[n],e,[n].concat(s));return}r=t[n],s=[n].concat(s)}let o=e[0];typeof o=="function"&&(o=o(r,s),o===r)||n===void 0&&o==null||(o=te(o),n===void 0||fe(r)&&fe(o)&&!Array.isArray(o)?wt(r,o):pe(t,n,o))}function _s(...[t,e]){const s=te(t||{}),n=Array.isArray(s),r=yt(s);function o(...i){Bt(()=>{n&&i.length===1?vs(s,i[0]):ne(s,i)})}return[r,o]}var ye={exports:{}},bt;function Ss(){if(bt)return ye.exports;bt=1;const t=s=>typeof crypto<"u"&&typeof crypto.getRandomValues=="function"?()=>{const n=crypto.getRandomValues(new Uint8Array(1))[0];return(n>=s?n%s:n).toString(s)}:()=>Math.floor(Math.random()*s).toString(s),e=(s=7,n=!1)=>Array.from({length:s},t(n?16:36)).join("");return ye.exports=e,ye.exports.default=e,ye.exports}var Ps=Ss();const Ae=Te(Ps);var Cs=()=>`uid::${Ae(7)}`,Is=(t,e=["endpointName","fingerprint"])=>typeof t=="object"&&t!==null&&e.every(s=>s in t),Ms=t=>{if(!Is(t))throw new TypeError("Invalid connection args");return JSON.stringify(t)},Ts=()=>{let t=[];return{add:(...e)=>{t=[...t,...e]},remove:e=>{t=typeof e=="string"?t.filter(s=>s.message.transactionId!==e):t.filter(s=>!e.includes(s))},entries:()=>t}},Ue=class{static toBackground(t,e){return t.postMessage(e)}static toExtensionContext(t,e){return t.postMessage(e)}},we={exports:{}},Os=we.exports,Et;function Rs(){return Et||(Et=1,function(t,e){(function(s,n){n(t)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Os,function(s){if(typeof globalThis!="object"||typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const n="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",o=i=>{const a={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(a).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class l extends WeakMap{constructor(f,A=void 0){super(A),this.createItem=f}get(f){return this.has(f)||this.set(f,this.createItem(f)),super.get(f)}}const c=g=>g&&typeof g=="object"&&typeof g.then=="function",u=(g,f)=>(...A)=>{i.runtime.lastError?g.reject(new Error(i.runtime.lastError.message)):f.singleCallbackArg||A.length<=1&&f.singleCallbackArg!==!1?g.resolve(A[0]):g.resolve(A)},d=g=>g==1?"argument":"arguments",p=(g,f)=>function(E,...C){if(C.length<f.minArgs)throw new Error(`Expected at least ${f.minArgs} ${d(f.minArgs)} for ${g}(), got ${C.length}`);if(C.length>f.maxArgs)throw new Error(`Expected at most ${f.maxArgs} ${d(f.maxArgs)} for ${g}(), got ${C.length}`);return new Promise((M,R)=>{if(f.fallbackToNoCallback)try{E[g](...C,u({resolve:M,reject:R},f))}catch(y){console.warn(`${g} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,y),E[g](...C),f.fallbackToNoCallback=!1,f.noCallback=!0,M()}else f.noCallback?(E[g](...C),M()):E[g](...C,u({resolve:M,reject:R},f))})},h=(g,f,A)=>new Proxy(f,{apply(E,C,M){return A.call(C,g,...M)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const _=(g,f={},A={})=>{let E=Object.create(null),C={has(R,y){return y in g||y in E},get(R,y,L){if(y in E)return E[y];if(!(y in g))return;let P=g[y];if(typeof P=="function")if(typeof f[y]=="function")P=h(g,g[y],f[y]);else if(w(A,y)){let J=p(y,A[y]);P=h(g,g[y],J)}else P=P.bind(g);else if(typeof P=="object"&&P!==null&&(w(f,y)||w(A,y)))P=_(P,f[y],A[y]);else if(w(A,"*"))P=_(P,f[y],A["*"]);else return Object.defineProperty(E,y,{configurable:!0,enumerable:!0,get(){return g[y]},set(J){g[y]=J}}),P;return E[y]=P,P},set(R,y,L,P){return y in E?E[y]=L:g[y]=L,!0},defineProperty(R,y,L){return Reflect.defineProperty(E,y,L)},deleteProperty(R,y){return Reflect.deleteProperty(E,y)}},M=Object.create(g);return new Proxy(M,C)},S=g=>({addListener(f,A,...E){f.addListener(g.get(A),...E)},hasListener(f,A){return f.hasListener(g.get(A))},removeListener(f,A){f.removeListener(g.get(A))}}),B=new l(g=>typeof g!="function"?g:function(A){const E=_(A,{},{getContent:{minArgs:0,maxArgs:0}});g(E)});let D=!1;const N=new l(g=>typeof g!="function"?g:function(A,E,C){let M=!1,R,y=new Promise(oe=>{R=function(k){D||(console.warn(r,new Error().stack),D=!0),M=!0,oe(k)}}),L;try{L=g(A,E,R)}catch(oe){L=Promise.reject(oe)}const P=L!==!0&&c(L);if(L!==!0&&!P&&!M)return!1;const J=oe=>{oe.then(k=>{C(k)},k=>{let tt;k&&(k instanceof Error||typeof k.message=="string")?tt=k.message:tt="An unexpected error occurred",C({__mozWebExtensionPolyfillReject__:!0,message:tt})}).catch(k=>{console.error("Failed to send onMessage rejected reply",k)})};return J(P?L:y),!0}),Qe=({reject:g,resolve:f},A)=>{i.runtime.lastError?i.runtime.lastError.message===n?f():g(new Error(i.runtime.lastError.message)):A&&A.__mozWebExtensionPolyfillReject__?g(new Error(A.message)):f(A)},et=(g,f,A,...E)=>{if(E.length<f.minArgs)throw new Error(`Expected at least ${f.minArgs} ${d(f.minArgs)} for ${g}(), got ${E.length}`);if(E.length>f.maxArgs)throw new Error(`Expected at most ${f.maxArgs} ${d(f.maxArgs)} for ${g}(), got ${E.length}`);return new Promise((C,M)=>{const R=Qe.bind(null,{resolve:C,reject:M});E.push(R),A.sendMessage(...E)})},O={devtools:{network:{onRequestFinished:S(B)}},runtime:{onMessage:S(N),onMessageExternal:S(N),sendMessage:et.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:et.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},m={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return a.privacy={network:{"*":m},services:{"*":m},websites:{"*":m}},_(i,O,a)};s.exports=o(chrome)}else s.exports=globalThis.browser})}(we)),we.exports}var Ls=Rs();const Ns=Te(Ls);var Ds=(t="")=>{const e=Cs();let s,n=[];const r=Ts(),o=new Set,i=new Set,a=(c,u)=>{switch(c.status){case"undeliverable":n.some(d=>d.message.messageID===c.message.messageID)||(n=[...n,{message:c.message,resolvedDestination:c.resolvedDestination}]);return;case"deliverable":n=n.reduce((d,p)=>p.resolvedDestination===c.deliverableTo?(Ue.toBackground(u,{type:"deliver",message:p.message}),d):[...d,p],[]);return;case"delivered":c.receipt.message.messageType==="message"&&r.add(c.receipt);return;case"incoming":c.message.messageType==="reply"&&r.remove(c.message.messageID),o.forEach(d=>d(c.message,u));return;case"terminated":{const d=r.entries().filter(p=>c.fingerprint===p.to);r.remove(d),d.forEach(({message:p})=>i.forEach(h=>h(p)))}}},l=()=>{s=Ns.runtime.connect({name:Ms({endpointName:t,fingerprint:e})}),s.onMessage.addListener(a),s.onDisconnect.addListener(l),Ue.toBackground(s,{type:"sync",pendingResponses:r.entries(),pendingDeliveries:[...new Set(n.map(({resolvedDestination:c})=>c))]})};return l(),{onFailure(c){i.add(c)},onMessage(c){o.add(c)},postMessage(c){Ue.toBackground(s,{type:"deliver",message:c})}}},je,ks=(t,e,s)=>je??(je=new Promise(n=>{const r=i=>{const{data:{cmd:a,scope:l,context:c},ports:u}=i;if(a==="webext-port-offer"&&l===e&&c!==t)return window.removeEventListener("message",r),u[0].onmessage=s,u[0].postMessage("port-accepted"),n(u[0])},o=()=>{const i=new MessageChannel;i.port1.onmessage=a=>{if(a.data==="port-accepted")return window.removeEventListener("message",r),n(i.port1);s?.(a)},window.postMessage({cmd:"webext-port-offer",scope:e,context:t},"*",[i.port2])};window.addEventListener("message",r),o()})),Fs=t=>{let e,s=!1,n,r;return{enable:()=>s=!0,onMessage:o=>n=o,postMessage:async o=>{if(!s)throw new Error("Communication with window has not been allowed");return $s(e),(await r).postMessage(o)},setNamespace:o=>{if(e)throw new Error("Namespace once set cannot be changed");e=o,r=ks(t,o,({data:i})=>n?.(i))}}};function $s(t){if(typeof t!="string"||t.trim().length===0)throw new Error(`webext-bridge uses window.postMessage to talk with other "window"(s) for message routingwhich is global/conflicting operation in case there are other scripts using webext-bridge. Call Bridge#setNamespace(nsps) to isolate your app. Example: setNamespace('com.facebook.react-devtools'). Make sure to use same namespace across all your scripts whereever window.postMessage is likely to be used\``)}var Us=Object.defineProperty,js=Object.defineProperties,Bs=Object.getOwnPropertyDescriptors,xt=Object.getOwnPropertySymbols,zs=Object.prototype.hasOwnProperty,Ws=Object.prototype.propertyIsEnumerable,vt=(t,e,s)=>e in t?Us(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,_t=(t,e)=>{for(var s in e||(e={}))zs.call(e,s)&&vt(t,s,e[s]);if(xt)for(var s of xt(e))Ws.call(e,s)&&vt(t,s,e[s]);return t},St=(t,e)=>js(t,Bs(e)),Ks=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,Pt=t=>{const[,e,s,n]=t.match(Ks)||[];return{context:e,tabId:+s,frameId:n?+n:void 0}};const Zs=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],Be=Symbol(".toJSON was called"),Gs=t=>{t[Be]=!0;const e=t.toJSON();return delete t[Be],e},Ct=({from:t,seen:e,to_:s,forceEnumerable:n,maxDepth:r,depth:o})=>{const i=s||(Array.isArray(t)?[]:{});if(e.push(t),o>=r)return i;if(typeof t.toJSON=="function"&&t[Be]!==!0)return Gs(t);for(const[a,l]of Object.entries(t)){if(typeof Buffer=="function"&&Buffer.isBuffer(l)){i[a]="[object Buffer]";continue}if(l!==null&&typeof l=="object"&&typeof l.pipe=="function"){i[a]="[object Stream]";continue}if(typeof l!="function"){if(!l||typeof l!="object"){i[a]=l;continue}if(!e.includes(t[a])){o++,i[a]=Ct({from:t[a],seen:[...e],forceEnumerable:n,maxDepth:r,depth:o});continue}i[a]="[Circular]"}}for(const{property:a,enumerable:l}of Zs)typeof t[a]=="string"&&Object.defineProperty(i,a,{value:t[a],enumerable:!0,configurable:!0,writable:!0});return i};function qs(t,e={}){const{maxDepth:s=Number.POSITIVE_INFINITY}=e;return typeof t=="object"&&t!==null?Ct({from:t,seen:[],forceEnumerable:!0,maxDepth:s,depth:0}):typeof t=="function"?`[Function: ${t.name||"anonymous"}]`:t}let It=()=>({events:{},emit(t,...e){(this.events[t]||[]).forEach(s=>s(...e))},on(t,e){return(this.events[t]=this.events[t]||[]).push(e),()=>this.events[t]=(this.events[t]||[]).filter(s=>s!==e)}});var Vs=(t,e,s)=>{const n=Ae(),r=new Map,o=new Map,i=a=>{if(a.destination.context===t&&!a.destination.frameId&&!a.destination.tabId){const{transactionId:l,messageID:c,messageType:u}=a,d=()=>{const h=r.get(l);if(h){const{err:w,data:_}=a;if(w){const S=w,B=self[S.name],D=new(typeof B=="function"?B:Error)(S.message);for(const N in S)D[N]=S[N];h.reject(D)}else h.resolve(_);r.delete(l)}},p=async()=>{let h,w,_=!1;try{const S=o.get(c);if(typeof S=="function")h=await S({sender:a.origin,id:c,data:a.data,timestamp:a.timestamp});else throw _=!0,new Error(`[webext-bridge] No handler registered in '${t}' to accept messages with id '${c}'`)}catch(S){w=S}finally{if(w&&(a.err=qs(w)),i(St(_t({},a),{messageType:"reply",data:h,origin:{context:t,tabId:null},destination:a.origin,hops:[]})),w&&!_)throw h}};switch(u){case"reply":return d();case"message":return p()}}return a.hops.push(`${t}::${n}`),e(a)};return{handleMessage:i,endTransaction:a=>{const l=r.get(a);l?.reject("Transaction was ended before it could complete"),r.delete(a)},sendMessage:(a,l,c="background")=>{const u=typeof c=="string"?Pt(c):c,d="Bridge#sendMessage ->";if(!u.context)throw new TypeError(`${d} Destination must be any one of known destinations`);return new Promise((p,h)=>{const w={messageID:a,data:l,destination:u,messageType:"message",transactionId:Ae(),origin:{context:t,tabId:null},hops:[],timestamp:Date.now()};r.set(w.transactionId,{resolve:p,reject:h});try{i(w)}catch(_){r.delete(w.transactionId),h(_)}})},onMessage:(a,l)=>(o.set(a,l),()=>o.delete(a))}},V=class{constructor(t,e){this.endpointRuntime=t,this.streamInfo=e,this.emitter=It(),this.isClosed=!1,this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},V.initDone||(t.onMessage("__crx_bridge_stream_transfer__",s=>{const{streamId:n,streamTransfer:r,action:o}=s.data,i=V.openStreams.get(n);i&&!i.isClosed&&(o==="transfer"&&i.emitter.emit("message",r),o==="close"&&(V.openStreams.delete(n),i.handleStreamClose()))}),V.initDone=!0),V.openStreams.set(this.streamInfo.streamId,this)}get info(){return this.streamInfo}send(t){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:t,action:"transfer"},this.streamInfo.endpoint)}close(t){t&&this.send(t),this.handleStreamClose(),this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:null,action:"close"},this.streamInfo.endpoint)}onMessage(t){return this.getDisposable("message",t)}onClose(t){return this.getDisposable("closed",t)}getDisposable(t,e){const s=this.emitter.on(t,e);return Object.assign(s,{dispose:s,close:s})}},be=V;be.initDone=!1,be.openStreams=new Map;var Hs=t=>{const e=new Map,s=new Map,n=It();t.onMessage("__crx_bridge_stream_open__",i=>new Promise(a=>{const{sender:l,data:c}=i,{channel:u}=c;let d=!1,p=()=>{};const h=()=>{const w=s.get(u);typeof w=="function"?(w(new be(t,St(_t({},c),{endpoint:l}))),d&&p(),a(!0)):d||(d=!0,p=n.on("did-change-stream-callbacks",h))};h()}));async function r(i,a){if(e.has(i))throw new Error("webext-bridge: A Stream is already open at this channel");const l=typeof a=="string"?Pt(a):a,c={streamId:Ae(),channel:i,endpoint:l},u=new be(t,c);return u.onClose(()=>e.delete(i)),await t.sendMessage("__crx_bridge_stream_open__",c,l),e.set(i,u),u}function o(i,a){if(s.has(i))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");s.set(i,a),n.emit("did-change-stream-callbacks")}return{openStream:r,onOpenStreamChannel:o}},ze=Fs("content-script"),We=Ds(),re=Vs("content-script",t=>{t.destination.context==="window"?ze.postMessage(t):We.postMessage(t)});ze.onMessage(t=>{t.origin={context:"window",tabId:null},re.handleMessage(t)}),We.onMessage(re.handleMessage),We.onFailure(t=>{if(t.origin.context==="window"){ze.postMessage({type:"error",transactionID:t.transactionId});return}re.endTransaction(t.transactionId)});var{sendMessage:Ee,onMessage:j}=re;Hs(re);const Js=t=>new Promise(e=>setTimeout(e,t));async function Xs(t,e=100,s=5e3){try{const n=t.innerHeight,r=Math.floor(Math.random()*5)+3;for(let o=0;o<r;o++){let i=0;i=Math.floor(Math.random()*n),t.scrollTo({top:i,behavior:"smooth"});const a=Math.floor(Math.random()*s)+e;await Js(a)}}catch(n){console.error("[Content Script] Error during random scroll:",n)}}var Ys=me("<h4>Email: "),Qs=me("<div class=hw-top><h4>Username: </h4><details><summary>ðŸ“Š Data Statistics</summary><div></div></details><div id=url-injection-container><div>ðŸ”— URL Injection Area</div><div id=injected-urls>"),en=me("<h4>Start scraping process at extension popup"),tn=me("<div>");const sn=t=>(()=>{var e=Qs(),s=e.firstChild;s.firstChild;var n=s.nextSibling,r=n.firstChild,o=r.nextSibling,i=n.nextSibling,a=i.firstChild,l=a.nextSibling;return e.style.setProperty("min-height","250px"),e.style.setProperty("min-width","250px"),e.style.setProperty("max-width","300px"),e.style.setProperty("background-color","#EE4D2D"),e.style.setProperty("color","white"),e.style.setProperty("padding","12px"),e.style.setProperty("font-family","system-ui, -apple-system, sans-serif"),e.style.setProperty("word-wrap","break-word"),e.style.setProperty("overflow-wrap","break-word"),e.style.setProperty("opacity","0.8"),e.style.setProperty("transition","opacity 0.2s ease"),Z(s,()=>t.state.username,null),Z(e,qt(Ht,{get when(){return t.state.email&&t.state.email!==""},get fallback(){return en()},get children(){var c=Ys();return c.firstChild,Z(c,()=>t.state.email,null),c}}),n),r.style.setProperty("cursor","pointer"),r.style.setProperty("padding","4px 0"),r.style.setProperty("font-weight","bold"),o.style.setProperty("background-color","rgba(0,0,0,0.2)"),o.style.setProperty("padding","8px"),o.style.setProperty("border-radius","4px"),o.style.setProperty("margin-top","4px"),o.style.setProperty("font-family","monospace"),Z(o,()=>JSON.stringify(t.state.crawlStats)?.replace(/[,\{\}]/g,`
`).replace(/["]/g,"").replace(/:1/g,": âœ…").split(`
`).filter(c=>c.trim()).map(c=>(()=>{var u=tn();return Z(u,c),u})())),i.style.setProperty("margin-top","8px"),i.style.setProperty("background-color","rgba(0,0,0,0.2)"),i.style.setProperty("padding","8px"),i.style.setProperty("border-radius","4px"),i.style.setProperty("min-height","20px"),i.style.setProperty("border","1px dashed rgba(255,255,255,0.3)"),a.style.setProperty("font-size","11px"),a.style.setProperty("opacity","0.7"),a.style.setProperty("margin-bottom","4px"),l.style.setProperty("font-size","12px"),e})();function nn(t){return new Promise(e=>{if(document.querySelector(t))return e(document.querySelector(t));const s=new MutationObserver(n=>{document.querySelector(t)&&(s.disconnect(),e(document.querySelector(t)))});s.observe(document.body,{childList:!0,subtree:!0})})}const Ke=(t,e)=>e.some(s=>t instanceof s);let Mt,Tt;function rn(){return Mt||(Mt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function on(){return Tt||(Tt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ze=new WeakMap,Ge=new WeakMap,xe=new WeakMap;function an(t){const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{s(W(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",o),t.addEventListener("error",i)});return xe.set(e,t),e}function ln(t){if(Ze.has(t))return;const e=new Promise((s,n)=>{const r=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{s(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});Ze.set(t,e)}let qe={get(t,e,s){if(t instanceof IDBTransaction){if(e==="done")return Ze.get(t);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return W(t[e])},set(t,e,s){return t[e]=s,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ot(t){qe=t(qe)}function cn(t){return on().includes(t)?function(...e){return t.apply(Ve(this),e),W(this.request)}:function(...e){return W(t.apply(Ve(this),e))}}function un(t){return typeof t=="function"?cn(t):(t instanceof IDBTransaction&&ln(t),Ke(t,rn())?new Proxy(t,qe):t)}function W(t){if(t instanceof IDBRequest)return an(t);if(Ge.has(t))return Ge.get(t);const e=un(t);return e!==t&&(Ge.set(t,e),xe.set(e,t)),e}const Ve=t=>xe.get(t);function dn(t,e,{blocked:s,upgrade:n,blocking:r,terminated:o}={}){const i=indexedDB.open(t,e),a=W(i);return n&&i.addEventListener("upgradeneeded",l=>{n(W(i.result),l.oldVersion,l.newVersion,W(i.transaction),l)}),s&&i.addEventListener("blocked",l=>s(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),r&&l.addEventListener("versionchange",c=>r(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const mn=["get","getKey","getAll","getAllKeys","count"],gn=["put","add","delete","clear"],He=new Map;function Rt(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(He.get(e))return He.get(e);const s=e.replace(/FromIndex$/,""),n=e!==s,r=gn.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||mn.includes(s)))return;const o=async function(i,...a){const l=this.transaction(i,r?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[s](...a),r&&l.done]))[0]};return He.set(e,o),o}Ot(t=>({...t,get:(e,s,n)=>Rt(e,s)||t.get(e,s,n),has:(e,s)=>!!Rt(e,s)||t.has(e,s)}));const fn=["continue","continuePrimaryKey","advance"],Lt={},Je=new WeakMap,Nt=new WeakMap,hn={get(t,e){if(!fn.includes(e))return t[e];let s=Lt[e];return s||(s=Lt[e]=function(...n){Je.set(this,Nt.get(this)[e](...n))}),s}};async function*pn(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const s=new Proxy(e,hn);for(Nt.set(s,e),xe.set(s,Ve(e));e;)yield s,e=await(Je.get(s)||e.continue()),Je.delete(s)}function Dt(t,e){return e===Symbol.asyncIterator&&Ke(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Ke(t,[IDBIndex,IDBObjectStore])}Ot(t=>({...t,get(e,s,n){return Dt(e,s)?pn:t.get(e,s,n)},has(e,s){return Dt(e,s)||t.has(e,s)}}));class H{db;static instance;listeners;constructor(){this.db=dn("magpie-settings-db",2,{upgrade(e){e.objectStoreNames.contains("settings")||e.createObjectStore("settings",{keyPath:"key"})}}),this.listeners=new Map}static getInstance(){return H.instance||(H.instance=new H),H.instance}async getSetting(e){try{return(await(await this.db).get("settings",e))?.value}catch(s){console.error(`Error retrieving setting "${e}":`,s);return}}async setSetting(e,s){try{await(await this.db).put("settings",{key:e,value:s}),this.notifyListeners(e,s)}catch(n){throw console.error(`Error storing setting "${e}":`,n),n}}subscribe(e,s){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e)?.add(s),()=>{this.listeners.get(e)?.delete(s)}}notifyListeners(e,s){this.listeners.get(e)?.forEach(n=>n(s))}}const T=H.getInstance();class b{static CONTAINER=document.documentElement||document.body;static CREDITS_URL="https://www.sadcaptcha.com/api/v1/license/credits?licenseKey=";static IMAGE_CRAWL_URL="https://www.sadcaptcha.com/api/v1/shopee-image-crawl?licenseKey=";static PUZZLE_URL="https://www.sadcaptcha.com/api/v1/puzzle?licenseKey=";static API_HEADERS=new Headers({"Content-Type":"application/json"});static IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR=".DfwepB";static IMAGE_CRAWL_PIECE_IMAGE_SELECTOR="#puzzleImgComponent";static IMAGE_CRAWL_BUTTON_SELECTOR="#sliderContainer > div > div";static IMAGE_CRAWL_RESET_BUTTON="button.CtJZAZ, button.XAny99";static IMAGE_CRAWL_UNIQUE_IDENTIFIERS=[b.IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR,b.IMAGE_CRAWL_PIECE_IMAGE_SELECTOR];static PUZZLE_BUTTON_SELECTOR='aside[aria-modal=true] div[style="width: 40px; height: 40px; transform: translateX(0px);"]';static PUZZLE_PUZZLE_IMAGE_SELECTOR="aside[aria-modal=true] div[aria-hidden=true] > div > div > img[draggable=false]";static PUZZLE_PIECE_IMAGE_SELECTOR="aside[aria-modal=true] div[aria-hidden=true] > div > div > img[draggable=true]";static PUZZLE_UNIQUE_IDENTIFIERS=["aside[aria-modal=true]"];static CAPTCHA_PRESENCE_INDICATORS=['aside[aria-modal=true] div[style="width: 40px; height: 40px; transform: translateX(0px);"]',"#NEW_CAPTCHA","#captchaMask"];isCurrentlySolving=!1;constructor(){window.hasRun!==!0&&(window.hasRun=!0,this.setupMessageListener(),this.solveCaptchaLoop())}setupMessageListener(){X.runtime.onMessage.addListener((e,s,n)=>{e.apiKey?(console.log("API key received: "+e.apiKey),localStorage.setItem("sadCaptchaKey",e.apiKey),n({message:"API key set.",success:1})):n({message:"API key cannot be empty.",success:0})})}getApiKey(){return"e14588b0e6cac1a4d35ad333c9bd4f3f"}async apiCall(e,s){console.log("Making API call to: "+e);const n=await fetch(e+this.getApiKey(),{method:"POST",headers:b.API_HEADERS,body:JSON.stringify(s)});return console.log("Received API response:",n),n}async creditsApiCall(){console.log("Checking API credits...");const s=await(await fetch(b.CREDITS_URL+this.getApiKey(),{method:"GET",headers:b.API_HEADERS})).json();return console.log("API credits = "+s.credits),s.credits}async imageCrawlApiCall(e){const n=await(await this.apiCall(b.IMAGE_CRAWL_URL,e)).json();return console.log("Pixels from slider origin = "+n.pixelsFromSliderOrigin),n.pixelsFromSliderOrigin}async puzzleApiCall(e,s){const r=await(await this.apiCall(b.PUZZLE_URL,{puzzleImageB64:e,pieceImageB64:s})).json();return console.log("slideXProportion = "+r.slideXProportion),r.slideXProportion}findFirstElementToAppear(e){return new Promise(s=>{const n=new MutationObserver(r=>{for(const o of r)if(o.addedNodes){for(const i of Array.from(o.addedNodes))for(const a of e)if(i instanceof Element&&i.querySelector(a)){console.debug(`Element matched ${a}`),n.disconnect(),s(i.querySelector(a));return}}});n.observe(b.CONTAINER,{childList:!0,subtree:!0})})}waitForElement(e){return new Promise(s=>{const n=document.querySelector(e);if(n){console.log("Selector found: "+e),s(n);return}const r=new MutationObserver(o=>{const i=document.querySelector(e);i&&(r.disconnect(),console.log("Selector found by mutation observer: "+e),s(i))});r.observe(b.CONTAINER,{childList:!0,subtree:!0})})}anySelectorInListPresent(e){return e.some(s=>document.querySelector(s)?(console.log(`Selector ${s} is present`),!0):!1)}async identifyCaptcha(){for(let e=0;e<30;e++){if(this.anySelectorInListPresent(b.IMAGE_CRAWL_UNIQUE_IDENTIFIERS))return console.log("Image crawl detected"),1;if(this.anySelectorInListPresent(b.PUZZLE_UNIQUE_IDENTIFIERS))return console.log("Puzzle detected"),0;await new Promise(s=>setTimeout(s,1e3))}throw new Error("Could not identify CaptchaType")}async getImageSource(e){const n=(await this.waitForElement(e)).getAttribute("src");if(!n)throw new Error(`Source attribute not found for selector: ${e}`);return console.log("src = "+n),n}getBase64StringFromDataURL(e){return e.replace(/^data:image\/[a-z]+;base64,/,"")}dispatchMouseEvent(e,s,n,r){(r||document.elementFromPoint(s,n)||b.CONTAINER).dispatchEvent(new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,clientX:s,clientY:n})),console.log(`Mouse ${e} at ${s}, ${n}`)}dispatchPointerEvent(e,s,n,r){(r||b.CONTAINER).dispatchEvent(new PointerEvent(e,{pointerType:"mouse",bubbles:!0,cancelable:!0,view:window,clientX:s,clientY:n})),console.log(`Pointer ${e} at ${s}, ${n}`)}mouseUp(e,s){this.dispatchMouseEvent("mouseup",e,s)}mouseDown(e,s){this.dispatchMouseEvent("mousedown",e,s)}mouseOver(e,s){this.dispatchMouseEvent("mouseover",e,s)}mouseMove(e,s,n){this.dispatchPointerEvent("mousemove",e,s,n)}clickElement(e){const s=document.querySelector(e);if(!s)throw new Error(`Element not found for selector: ${e}`);const n=s.getBoundingClientRect(),r=n.x+n.width/2,o=n.y+n.height/2;this.mouseMove(r,o),this.mouseOver(r,o),this.dispatchPointerEvent("click",r,o,s)}getElementCenter(e){const s=e.getBoundingClientRect(),n={x:s.x+s.width/2,y:s.y+s.height/2};return console.log("Element center:",n),n}getElementWidth(e){const s=e.getBoundingClientRect().width;return console.log("Element width: "+s),s}computePuzzleSlideDistance(e,s){const n=s.getBoundingClientRect().width*e;return console.log("Puzzle slide distance = "+n),n}async refreshImageCrawl(){const e=await this.getImageSource(b.IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR);for(this.clickElement(b.IMAGE_CRAWL_RESET_BUTTON);await this.getImageSource(b.IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR)===e;)console.log("Waiting for refresh..."),await new Promise(s=>setTimeout(s,100));console.log("Refresh complete")}generateNaturalApproach(e,s,n){const r={x:e.x+(s.x-e.x)*(.2+Math.random()*.2),y:e.y+(Math.random()*15-5)},o={x:e.x+(s.x-e.x)*(.6+Math.random()*.2),y:s.y+(Math.random()*10-5)},i=[];for(let a=0;a<=n;a++){const l=a/n,c=Math.pow(1-l,3)*e.x+3*Math.pow(1-l,2)*l*r.x+3*(1-l)*Math.pow(l,2)*o.x+Math.pow(l,3)*s.x,u=Math.pow(1-l,3)*e.y+3*Math.pow(1-l,2)*l*r.y+3*(1-l)*Math.pow(l,2)*o.y+Math.pow(l,3)*s.y;i.push({x:c,y:u})}return i}async mouseApproach(e,s){const n=e-80-Math.random()*40,r=s+40+Math.random()*30,o=this.generateNaturalApproach({x:n,y:r},{x:e,y:s},8+Math.floor(Math.random()*4));for(const i of o)this.mouseMove(i.x,i.y),await new Promise(a=>setTimeout(a,15+Math.random()*25));await new Promise(i=>setTimeout(i,200+Math.random()*150)),this.mouseMove(e+(Math.random()*1.5-.75),s+(Math.random()*1.5-.75))}rotateAngleFromStyle(e){const s=/rotate\((.+)deg\)/,n=e.match(s);return n?parseFloat(n[1]):0}xyToProportionalPoint(e,s){return{proportionX:(s.x-e.x)/e.width,proportionY:(s.y-e.y)/e.height}}getTrajectoryElement(e,s,n){const r=n.getAttribute("style")||"",o=this.rotateAngleFromStyle(r),i=this.getElementCenter(n);return{piece_center:this.xyToProportionalPoint(s,i),piece_rotation_angle:o,pixels_from_slider_origin:e}}async getSlidePieceTrajectory(e,s){const n=document.querySelector(b.IMAGE_CRAWL_PIECE_IMAGE_SELECTOR);if(!n)throw new Error("Slider piece container not found");const r=this.getElementWidth(s),o=this.getElementCenter(e),i=s.getBoundingClientRect(),a=[],l=3;let c=o;this.mouseDown(o.x,o.y),await new Promise(u=>setTimeout(u,180+Math.random()*120));for(let u=0;u<r*.85;u+=l){const d=o.x+u,p=o.y-Math.log(u+1);this.mouseMove(d,p,e),await new Promise(w=>setTimeout(w,10));const h=this.getTrajectoryElement(u,i,n);a.push(h),c={x:d,y:p}}return{trajectory:a,lastPosition:c}}async solveImageCrawl(){await this.refreshImageCrawl(),await new Promise(h=>setTimeout(h,500));const[e,s]=await Promise.all([this.getImageSource(b.IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR),this.getImageSource(b.IMAGE_CRAWL_PIECE_IMAGE_SELECTOR)]),n=this.getBase64StringFromDataURL(e),r=this.getBase64StringFromDataURL(s),o=document.querySelector(b.IMAGE_CRAWL_BUTTON_SELECTOR),i=document.querySelector(b.IMAGE_CRAWL_PUZZLE_IMAGE_SELECTOR);if(!o||!i)throw new Error("Image crawl elements not found");const a=this.getElementCenter(o);await this.mouseApproach(a.x,a.y),await new Promise(h=>setTimeout(h,350+Math.random()*200));const{trajectory:l,lastPosition:c}=await this.getSlidePieceTrajectory(o,i),u=await this.imageCrawlApiCall({piece_image_b64:r,puzzle_image_b64:n,slide_piece_trajectory:l}),d=a.x+u,p=this.generateNaturalApproach(c,{x:d,y:a.y},20+Math.floor(Math.random()*10));for(const h of p)this.mouseMove(h.x,h.y),await new Promise(w=>setTimeout(w,20+Math.random()*30));await new Promise(h=>setTimeout(h,100+Math.random()*150)),this.mouseUp(d,a.y)}async solvePuzzle(){await new Promise(p=>setTimeout(p,3e3));const e=document.querySelector(b.PUZZLE_BUTTON_SELECTOR);if(!e)throw new Error("Puzzle slider button not found");const s=this.getElementCenter(e);await this.mouseApproach(s.x,s.y),await new Promise(p=>setTimeout(p,133.7)),this.mouseDown(s.x,s.y),await new Promise(p=>setTimeout(p,133.7));const[n,r]=await Promise.all([this.getImageSource(b.PUZZLE_PUZZLE_IMAGE_SELECTOR),this.getImageSource(b.PUZZLE_PIECE_IMAGE_SELECTOR)]),o=this.getBase64StringFromDataURL(n),i=this.getBase64StringFromDataURL(r),a=await this.puzzleApiCall(o,i),l=document.querySelector(b.PUZZLE_PUZZLE_IMAGE_SELECTOR);if(!l)throw new Error("Puzzle image element not found");const c=this.computePuzzleSlideDistance(a,l),u=s.x+c,d=this.generateNaturalApproach(s,{x:u,y:s.y},25+Math.floor(Math.random()*15));for(const p of d)this.mouseMove(p.x,p.y),await new Promise(h=>setTimeout(h,25+Math.random()*20));await new Promise(p=>setTimeout(p,133.7)),this.mouseUp(u,s.y)}captchaIsPresent(){return b.CAPTCHA_PRESENCE_INDICATORS.some(e=>document.querySelector(e)?(console.log("Captcha present based on selector: "+e),!0):!1)}async solveCaptchaLoop(){let e=0;for(;e<5;){if(!this.isCurrentlySolving){this.captchaIsPresent()||(console.log("Waiting for captcha..."),await this.findFirstElementToAppear(b.CAPTCHA_PRESENCE_INDICATORS),console.log("Captcha detected by mutation observer.")),this.isCurrentlySolving=!0;try{if(await this.creditsApiCall()<=0){this.isCurrentlySolving=!1;continue}switch(await this.identifyCaptcha()){case 0:await this.solvePuzzle();break;case 1:await this.solveImageCrawl();break}}catch(s){console.error("Error during captcha solving process:",s)}finally{this.isCurrentlySolving=!1,await new Promise(s=>setTimeout(s,5e3))}}await new Promise(s=>setTimeout(s,1e3)),e++}}async solveCaptchaOnce(){try{if(await this.creditsApiCall()<=0)return console.log("Out of credits"),{isSolved:!1,message:"Out of SadCaptcha credits."};switch(await this.identifyCaptcha()){case 0:await this.solvePuzzle();break;case 1:await this.solveImageCrawl();break}return console.log("Captcha solve attempt finished."),{isSolved:!0,message:"Captcha solve attempt finished."}}catch(e){return console.error("Error during single captcha solve:",e),{isSolved:!1,message:"Error during single captcha solve:"+e}}}static async attemptSolve(){const e=new b;try{return await e.solveCaptchaLoop(),!0}catch(s){return console.error("Captcha solving attempt failed:",s),!1}}}function kt(t,e){const[s,n]=ot(e);return it(()=>{console.log(`Syncing with settings key: "${t}"`),T.getSetting(t).then(i=>{i!==void 0&&n(()=>i)});const o=T.subscribe(t,i=>{n(()=>i)});zt(()=>{console.log(`Unsubscribing from settings key: "${t}"`),o()})}),[s,async o=>{await T.setSetting(t,o)}]}const yn="scraperbot",An={matches:["*://*.shopee.co.id/*","*://*.shopee.com.my/*","*://*.shopee.ph/*","*://*.shopee.sg/*","*://*.shopee.co.th/*","*://*.shopee.vn/*"],cssInjectionMode:"ui",async main(t){var e=document.createElement("script");e.src=X.runtime.getURL("/inject.js"),e.onload=function(){this.parentNode.removeChild(this)},(document.head||document.documentElement).appendChild(e);const[s,n]=kt("username",await T.getSetting("username")||""),[r,o]=kt("email",await T.getSetting("email")||""),[i,a]=_s({message:"",currentTask:"",crawlStats:{},isFetching:!1,username:s()||await T.getSetting("username"),email:r()||await T.getSetting("email")});it(async()=>{await Ee("getBackgroundState",{}).then(d=>{console.log("Background state:",d),d&&a("isFetching",d.isFetching)}),nn("div.navbar__username").then(async()=>{const d=document.querySelector("div.navbar__username");d&&d.textContent&&d.textContent.trim()!==""&&(a("username",d.textContent),n(d.textContent),await Ee("reportUsername",d.textContent),await T.setSetting("username",d.textContent))});const u=await T.getSetting("email");console.log("Email from settings:",u),a("email",u)}),(await wn(t,i)).mount(),j("updateCurrentTask",({data:u})=>{a("currentTask",u.task)}),j("updateMessage",({data:u})=>{a("message",u.message)}),j("updateEmail",async({data:u})=>{await T.setSetting("email",u.email),o(u.email),a("email",u.email)}),j("updateRegion",({data:u})=>{Ee("reportRegion",{region:u.region}),a("region",u.region)}),j("updateFetchingStatus",({data:u})=>{a("isFetching",u.isFetching)}),j("performRandomScroll",async()=>{await Xs(window)}),j("solveCaptcha",async()=>{console.log("Received request to solve captcha. Starting now."),await new b().solveCaptchaOnce()}),j("clickUrl",async({data:u})=>{a("message","Navigating to next task..."),await bn(u.url)});async function c(u){a("crawlStats",u,d=>(d||0)+1)}window.addEventListener("message",async function(u){const{type:d,data:p,url:h}=u.data;if(d!=="fetch")return;const w={"/api/v4/pdp/hot_sales/get":["pdp.hot_sales",m=>({data:m.data})],"/api/v4/pdp/get_pc":["pdp.get_pc",m=>({detail:m.data,error:m.error})],"/api/v4/collection/get_items":["home.collection_items",m=>({data:m.data})],"/api/v2/item/get_ratings":["pdp.get_ratings",m=>({data:m.data})],"/api/v4/recommend/recommend":["home.recommend",m=>({data:m.data})],"/api/v4/recommend/recommend_post":["home.recommend_post",m=>({data:m.data})],"/api/v4/recommend/product_detail_page":["pdp.recommend_pdp",m=>({data:m.data})],"/api/v4/search/search_items":["search.search_items",m=>({items:m.items})],"/api/v4/search/search_user":["search.search_user",m=>({data:m.data})],"/api/v4/search/search_filter_config":["search.search_filter_config",m=>({data:m.data})],"/api/v4/search/search_mart_items":["supermarket.search_mart_items",m=>({items:m.data})],"/api/v4/mart/home/get_horizontal_collection":["supermarket.horizontal_collection",m=>({data:m.data})],"/api/v4/shop/search_items":["shop.sold_out",m=>({items:m.items})],"/api/v4/shop/get_shop_base":["shop.shop_base",m=>({response:m})],"/api/v4/shop/get_shop_seo":["shop.shop_seo",m=>({response:m.data})],"/api/v4/shop/get_shop_tab":["shop.shop_tab",m=>({items:m.data})],"/api/v4/shop/rcmd_items":["shop.rcmd_items",m=>({items:m.data})],"/api/v4/traffic/page_component/get_mart_home_page":["supermarket.mart_home_page",m=>({items:m.data})],"/api/v4/flash_sale/spm/get_all_sessions":["flash_sale.all_sessions",m=>({data:m.data})],"/api/v4/flash_sale/spm/get_all_itemids":["flash_sale.all_itemids",m=>({data:m.data})],"/api/v4/flash_sale/flash_sale_batch_get_items":["flash_sale.batch_items",m=>({data:m.data})],"/api/v2/voucher_wallet/get_user_voucher_by_time":["shop.user_voucher",m=>({response:m.data})],"/api/v2/voucher_wallet/get_voucher_detail":["shop.voucher_detail",m=>({response:m.data})]},_=Object.keys(w).find(m=>h.includes(m));if(!_)return;const[S,B]=w[_],D=await T.getSetting("email");if(!D){console.error("Email not found in storage, cannot send webhook.");return}const N=await T.getSetting("username")||yn,Qe=window.location.href;let O={api_url:h,page_url:Qe,email:D,username:N,...B(p)};console.log(`Webhook payload for ${S}: `,O),await Ee("webhook",{payload:{...O,data:O.data?JSON.parse(JSON.stringify(O.data)):void 0,items:O.items?JSON.parse(JSON.stringify(O.items)):void 0,detail:O.detail?JSON.parse(JSON.stringify(O.detail)):void 0,response:O.response?JSON.parse(JSON.stringify(O.response)):void 0}}),await c(`${S}.${D}.${N}`)})}};function wn(t,e){return ps(t,{name:"shopee-overlay",position:"overlay",css:`
      .hw-top {
        position: fixed;
        top: 0;
        left: 0;
        max-width: 200px;
        z-index: 999999;
        background-color: #EE4D2D;
        color: white;
        padding: 4px;
      }
    `,onMount(s){return ws(()=>sn({state:e}),s)},onRemove(s){s?.()}})}function bn(t){const e=document.createElement("a");e.href=t,e.style.display="none",document.body.appendChild(e),e.click(),setTimeout(()=>e.remove(),100)}class Xe extends Event{constructor(e,s){super(Xe.EVENT_NAME,{}),this.newUrl=e,this.oldUrl=s}static EVENT_NAME=Ye("wxt:locationchange")}function Ye(t){return`${X?.runtime?.id}:content:${t}`}function En(t){let e,s;return{run(){e==null&&(s=new URL(location.href),e=t.setInterval(()=>{let n=new URL(location.href);n.href!==s.href&&(window.dispatchEvent(new Xe(n,s)),s=n)},1e3))}}}class ve{constructor(e,s){this.contentScriptName=e,this.options=s,this.abortController=new AbortController,this.isTopFrame?(this.listenForNewerScripts({ignoreFirstEvent:!0}),this.stopOldScripts()):this.listenForNewerScripts()}static SCRIPT_STARTED_MESSAGE_TYPE=Ye("wxt:content-script-started");isTopFrame=window.self===window.top;abortController;locationWatcher=En(this);receivedMessageIds=new Set;get signal(){return this.abortController.signal}abort(e){return this.abortController.abort(e)}get isInvalid(){return X.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(e){return this.signal.addEventListener("abort",e),()=>this.signal.removeEventListener("abort",e)}block(){return new Promise(()=>{})}setInterval(e,s){const n=setInterval(()=>{this.isValid&&e()},s);return this.onInvalidated(()=>clearInterval(n)),n}setTimeout(e,s){const n=setTimeout(()=>{this.isValid&&e()},s);return this.onInvalidated(()=>clearTimeout(n)),n}requestAnimationFrame(e){const s=requestAnimationFrame((...n)=>{this.isValid&&e(...n)});return this.onInvalidated(()=>cancelAnimationFrame(s)),s}requestIdleCallback(e,s){const n=requestIdleCallback((...r)=>{this.signal.aborted||e(...r)},s);return this.onInvalidated(()=>cancelIdleCallback(n)),n}addEventListener(e,s,n,r){s==="wxt:locationchange"&&this.isValid&&this.locationWatcher.run(),e.addEventListener?.(s.startsWith("wxt:")?Ye(s):s,n,{...r,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),De.debug(`Content script "${this.contentScriptName}" context invalidated`)}stopOldScripts(){window.postMessage({type:ve.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName,messageId:Math.random().toString(36).slice(2)},"*")}verifyScriptStartedEvent(e){const s=e.data?.type===ve.SCRIPT_STARTED_MESSAGE_TYPE,n=e.data?.contentScriptName===this.contentScriptName,r=!this.receivedMessageIds.has(e.data?.messageId);return s&&n&&r}listenForNewerScripts(e){let s=!0;const n=r=>{if(this.verifyScriptStartedEvent(r)){this.receivedMessageIds.add(r.data.messageId);const o=s;if(s=!1,o&&e?.ignoreFirstEvent)return;this.notifyInvalidated()}};addEventListener("message",n),this.onInvalidated(()=>removeEventListener("message",n))}}function Sn(){}function _e(t,...e){}const xn={debug:(...t)=>_e(console.debug,...t),log:(...t)=>_e(console.log,...t),warn:(...t)=>_e(console.warn,...t),error:(...t)=>_e(console.error,...t)};return(async()=>{try{const{main:t,...e}=An,s=new ve("content",e);return await t(s)}catch(t){throw xn.error('The content script "content" crashed on startup!',t),t}})()}();
content;
